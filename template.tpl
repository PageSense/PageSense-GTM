___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.

___INFO___

{
  "displayName": "PageSense Tag",
  "description": "This tag will inject PageSense\u0027s tracking code snippet on the website pages that have the Google Tag Manager snippet installed.",
  "categories": ["EXPERIMENTATION", "PERSONALIZATION", "HEAT_MAP", "ANALYTICS", "CONVERSIONS", "SESSION_RECORDING"],
  "securityGroups": [],
  "id": "cvt_temp_public_id",
  "type": "TAG",
  "version": 1,
  "brand": {
    "thumbnail": "data:image/png;base64,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",
    "displayName": "",
    "id": "brand_dummy"
  },
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "help": "You can get the space name in the Project Info section under the Settings tab of your PageSense app.",
    "displayName": "Space name",
    "simpleValueType": true,
    "name": "portalName",
    "type": "TEXT"
  },
  {
    "help": "You can get the project key in the Project Info section under the Settings tab of your PageSense app.",
    "displayName": "Project key",
    "simpleValueType": true,
    "name": "projectKey",
    "type": "TEXT"
  },
  {
    "help": "You can get the data center in the Project Info section under the Settings tab of your PageSense app.",
    "macrosInSelect": false,
    "selectItems": [
      {
        "displayValue": "US",
        "value": "cdn.pagesense.io"
      },
      {
        "displayValue": "EU",
        "value": "cdn-eu.pagesense.io"
      },
      {
        "displayValue": "IN",
        "value": "cdn-in.pagesense.io"
      },
      {
        "displayValue": "CN",
        "value": "cdn.pagesense.cn"
      },
      {
        "displayValue": "AU",
        "value": "cdn-au.pagesense.io"
      },
      {
        "value": "cdn-jp.pagesense.io",
        "displayValue": "JP"
      },
      {
        "value": "cdn-ca.pagesense.io",
        "displayValue": "CA"
      },
      {
        "value": "cdn-sa.pagesense.io",
        "displayValue": "SA"
      },
      {
        "value": "cdn-ae.pagesense.io",
        "displayValue": "UAE"
      }
    ],
    "displayName": "Data center",
    "simpleValueType": true,
    "name": "dataCenter",
    "type": "SELECT"
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Enter your template code here.
const injectScript = require('injectScript');
const queryPermission = require('queryPermission');
const encodeUriComponent = require('encodeUriComponent');

const portalName = data.portalName;
const projectKey = data.projectKey;
const dataCenter = data.dataCenter;

const url = 
'https://' + encodeUriComponent(dataCenter) + '/js/' + encodeUriComponent(portalName) + '/' + encodeUriComponent(projectKey) + '.js'; 

const onSuccess = () => {
  data.gtmOnSuccess();
};

const onFailure = () => {
  data.gtmOnFailure();
};

if (queryPermission('inject_script', url)) {
  injectScript(url, data.gtmOnSuccess(), data.gtmOnFailure());
  

} else {
  data.gtmOnFailure();
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://*.pagesense.io/"
              },
              {
                "type": 1,
                "string": "https://*.pagesense.cn/"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 24/03/2025, 10:34:31


